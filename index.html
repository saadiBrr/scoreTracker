<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Score</title>
<style>
    .scorecard {
        border: 1px solid black;
        padding: 10px;
        margin-top: 10px;
    }
    #score {
        font-size: 40px;
        font-weight: bold;
        margin-bottom: 10px;
    }
    .hidden {
        display: none;
    }
    .on-strike {
        background-color: yellow;
    }
    .out {
        background-color: lightgray;
    }
    #runButtons button {
        font-size: 18px;
        padding: 10px 20px;
        margin: 5px;
    }
</style>
</head>
<body>
    <label for="players">Number of Players:</label>
    <select id="players" onchange="updatePlayerNames()">
        <option value="1">1 Player</option>
        <option value="2">2 Players</option>
        <option value="3">3 Players</option>
    </select>
    <br><br>
    <div id="playerNames">
        <label for="player1">Player 1 Name:</label>
        <input type="text" id="player1" value="Player 1">
        <br><br>
    </div>
    <br><br>
    <button id="startButton" onclick="startGame()">Start Game</button>
    <br><br>
    <div id="score" class="hidden"></div>
    <div class="scorecard" id="scorecard" class="hidden"></div>

    <!-- Buttons for adding runs -->
    <div id="runButtons" class="hidden">
        <button onclick="addRun(0)">Dot</button>
        <button onclick="addRun(1)">1</button>
        <button onclick="addRun(2)">2</button>
        <button onclick="addRun(3)">3</button>
        <button onclick="addRun(4)">4</button>
        <button onclick="addRun(6)">6</button>
        <button onclick="addWide()">Wd</button>
        <button onclick="addNoBall()">Nb</button>
        <button onclick="addBouncer()">Bouncer</button>
        <button onclick="undoLastAction()">Undo</button>
        <button onclick="resetMatch()">Reset</button>
    </div>
    <!-- End of run buttons -->

    <script>
        let numPlayers = 0;
        let currentPlayer = 1;
        let players = {};
        let wickets = 0;
        let overs = 0;
        let ballsThisOver = 0;
        let totalBallsPerOver = 6; // Assuming 6 balls per over

        function updatePlayerNames() {
            let numPlayers = parseInt(document.getElementById('players').value);
            let playerNamesHTML = '';
            for (let i = 1; i <= numPlayers; i++) {
                let playerName = players[i] ? players[i].name : '';
                playerNamesHTML += `<label for="player${i}">Player ${i} Name:</label>
                <input type="text" id="player${i}" value="Player ${i}">
                <br><br>`;
            }
            document.getElementById('playerNames').innerHTML = playerNamesHTML;
        }

        function updateScorecard() {
            let scorecard = document.getElementById('scorecard');
            scorecard.innerHTML = '';
            for (let player in players) {
                if (players[player].balls >= 0) {
                    scorecard.innerHTML += `<p id="player${player}" class="${currentPlayer === parseInt(player) ? 'on-strike' : ''}">${players[player].name}: ${players[player].runs} (${players[player].balls}) [4s: ${players[player].fours}, 6s: ${players[player].sixes}, Extras: ${players[player].extras}, Strike Rate: ${(players[player].runs / players[player].balls * 100).toFixed(2)}]</p>`;
                }
            }
        }

        function startGame() {
            console.log('Starting Game')
            let numPlayers = parseInt(document.getElementById('players').value);
            let playerNames = [];
            for (let i = 1; i <= numPlayers; i++) {
                let playerName = document.getElementById('player' + i).value;
                if (playerName.trim() !== '') {
                    playerNames.push(playerName);
                }
            }
            if (playerNames.length === numPlayers || numPlayers === 1) {
                for (let i = 1; i <= numPlayers; i++) {
                    players[i] = { name: playerNames[i - 1], runs: 0, balls: 0, fours: 0, sixes: 0, extras: 0, notOut: 0};
                }
                document.getElementById('playerNames').classList.add('hidden');
                document.getElementById('players').classList.add('hidden');
                document.getElementById('startButton').classList.add('hidden');
                document.getElementById('score').classList.remove('hidden');
                document.getElementById('scorecard').classList.remove('hidden');
                document.getElementById('runButtons').classList.remove('hidden');
                updateScore();
                updateScorecard();
                document.getElementById('player1').classList.add('on-strike');

            } else {
                alert('Please enter names for all players.');
            }
        }

        function updateScore() {
            let totalRuns = 0;
            let totalBalls = 0;
            for (let player in players) {
                totalRuns += players[player].runs;
                totalBalls += players[player].balls;
            }
            let oversCompleted = Math.floor(totalBalls / totalBallsPerOver);
            let ballsRemaining = totalBalls % totalBallsPerOver;

            let score = document.getElementById('score');
            score.innerHTML = `${totalRuns}/${wickets} (${oversCompleted}.${ballsRemaining} overs)`;
        }

        function switchOver() {
            ballsThisOver = 0;
            overs++; // Increment the over count
            updateScore();
        }

        function switchStrike() {
    // Remove the "on-strike" class from the current player
    let currentPlayerElement = document.getElementById('player' + currentPlayer);
    currentPlayerElement.classList.remove('on-strike');
    console.log("Removing on-strike from " +currentPlayer);

    // Switch strike to the other player
    if (currentPlayer === 1) {
        currentPlayer = 2;
    } else {
        currentPlayer = 1;
    }

    // Add the "on-strike" class to the new player
    currentPlayerElement = document.getElementById('player' + currentPlayer);
    currentPlayerElement.classList.add('on-strike');
    console.log("Adding on-strike to " +currentPlayer);

    updateScore();
}

        function switchStrikeIfSingleOrTriple(run) {
            console.log("Switching strike if single or triple");
    if (run === 1 || run === 3) {
        if (ballsThisOver !== totalBallsPerOver) {
            switchStrike(); // Switch strike if 1 or 3 on any ball except the 6th ball
        }
    }
}

        function addRun(run) {
    players[currentPlayer].runs += run;
    players[currentPlayer].balls++;
    ballsThisOver++;

    updateScorecard();
    updateScore();

    if (run === 4) {
        players[currentPlayer].fours++;
    } else if (run === 6) {
        players[currentPlayer].sixes++;
    }

    if (ballsThisOver === totalBallsPerOver) {
        switchOver();
        if (run !== 1 && run !== 3) {
            switchStrike(); // Switch strike if not 1 or 3 on the 6th ball
        }
    } else if (ballsThisOver < totalBallsPerOver) {
        switchStrikeIfSingleOrTriple(run);
    }
}

        function addWide() {
            players[currentPlayer].runs++;
            players[currentPlayer].extras++;
            updateScorecard();
            updateScore();
        }

        function addNoBall() {
            players[currentPlayer].runs++;
            players[currentPlayer].extras++;
            updateScorecard();
            updateScore();
        }

        function addBouncer() {
            // Additional functionality for bouncer can be added here
        }

        function undoLastAction() {
            // Additional functionality for undoing the last action can be added here
        }
        
        function resetMatch() {
            // Reset all player scores and stats
    for (let player in players) {
        players[player].runs = 0;
        players[player].balls = 0;
        players[player].fours = 0;
        players[player].sixes = 0;
        players[player].extras = 0;
    }

    // Reset other game variables
    wickets = 0;
    overs = 0;
    ballsThisOver = 0;

    // Reset score and scoreboard display
    updateScore();
    updateScorecard();

    // Remove the "on-strike" class from all players
    let allPlayers = document.querySelectorAll('.on-strike');
    allPlayers.forEach(player => {
        player.classList.remove('on-strike');
    });

    // Add the "on-strike" class to player 1
    document.getElementById('player1').classList.add('on-strike');

    console.log("RESET")
        }
    </script>
</body>
</html>
